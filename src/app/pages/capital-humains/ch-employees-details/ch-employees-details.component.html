<div class="subscribe-header">
    <img src="assets/images/bg.jpg" class="img-fluid w-100" alt="Admin &amp;
        Dashboards">
</div>

<div class="subscriber-body">

    <!-- Row start -->
    <div class="row justify-content-center mt-5">
        <div class="col-xl-10 col-lg-12">
            <!-- Row start -->
            <div class="row align-items-end">
                <div class="col-auto">
                    <img [src]="old_image"
                        class="img-8xx img-fluid rounded-circle border border-primary border-4">
                </div>
            </div>
            <!-- Row end -->
        </div>
    </div>
    <!-- Row end -->
    <div class="row justify-content-center mt-5">
        <div class="col-xxl-12 col-sm-12 col-12">
            <div class="card ">

                <div class="card-body ">

                    <mat-tab-group>
                        <mat-tab>
                            <ng-template mat-tab-label>
                                <mat-icon
                                    class="example-tab-icon me-2">person</mat-icon>
                                <span class="text-primary fs-5">
                                    Information personnelle
                                </span>
                            </ng-template>
                            <div class="row gx-3 mt-3 m-3">

                                <div class="col-md-3 col-lg-3">
                                    <mat-form-field
                                        appearance="outline">
                                        <mat-label>Prénom <code
                                                class="fs-4">*</code></mat-label>
                                        <input [(ngModel)]="first_name"
                                            matInput
                                            [readonly]="is_disabled == true"
                                            placeholder="Prénom">
                                    </mat-form-field>
                                </div>

                                <div class="col-md-3 col-lg-3">
                                    <mat-form-field
                                        appearance="outline">
                                        <mat-label>Nom de famille <code
                                                class="fs-4">*</code></mat-label>
                                        <input [(ngModel)]="last_name"
                                            [readonly]="is_disabled == true"
                                            matInput
                                            placeholder="Nom de famille">
                                    </mat-form-field>
                                </div>
                                <div class="col-md-3 col-sm-6 col-lg-3">
                                    <mat-form-field
                                        appearance="outline">
                                        <mat-label>Profession<code
                                                class="fs-4">*</code></mat-label>
                                        <input [(ngModel)]="profession"
                                            matInput
                                            [readonly]="is_disabled == true"
                                            placeholder="Profession ">
                                    </mat-form-field>
                                </div>
                                <div class="col-md-3 col-lg-3">
                                    <mat-form-field
                                        appearance="outline">
                                        <mat-label>Intitulé du diplôme <code
                                                class="fs-4">*</code></mat-label>
                                        <input [(ngModel)]="diplome"
                                            [readonly]="is_disabled == true"
                                            matInput
                                            placeholder="Intitulé du diplôme">
                                    </mat-form-field>
                                </div>

                                <div class="col-md-3 col-sm-6 col-lg-3">
                                    <mat-form-field
                                        appearance="outline">
                                        <mat-label>Genre<code
                                                class="fs-4">*</code></mat-label>
                                        <mat-select
                                            [disabled]="is_disabled == true"
                                            [(value)]="selectedGenreOption"
                                            (selectionChange)="selectGenre($event)">
                                            @for (item_genre of list_genre; track $index) {
                                                <mat-option
                                                    [value]="item_genre.genre">{{
                                                    item_genre.genre }}
                                                </mat-option>
                                            }
                                        </mat-select>
                                    </mat-form-field>
                                </div>

                                <div class="col-md-3 col-sm-6 col-lg-3">
                                    <mat-form-field
                                        appearance="outline">
                                        <mat-label>Adresse email <code
                                                class="fs-4">*</code></mat-label>
                                        <input [(ngModel)]="adresse_email"
                                            type="email" matInput
                                            [readonly]="is_disabled == true"
                                            placeholder="Adresse email">
                                    </mat-form-field>
                                </div>

                                <div class="col-md-3 col-sm-6 col-lg-3">
                                    <mat-form-field
                                        appearance="outline">
                                        <mat-label>Numéro téléphone
                                            <code
                                                class="fs-4">*</code></mat-label>
                                        <input [(ngModel)]="phone"
                                            type="tel"
                                            [readonly]="is_disabled == true"
                                            matInput
                                            placeholder="Numéro téléphone">
                                    </mat-form-field>
                                </div>

                                <div class="col-md-3 col-sm-6 col-lg-3">
                                    <mat-form-field
                                        appearance="outline">
                                        <mat-label>Date de naissance
                                            <code
                                                class="fs-4">*</code></mat-label>
                                        <input
                                            [(ngModel)]="date_naissance"
                                            matInput
                                            [readonly]="is_disabled == true"
                                            [matDatepicker]="pickerDateNaissance">
                                        <mat-datepicker-toggle matIconSuffix
                                            [for]="pickerDateNaissance"></mat-datepicker-toggle>
                                        <mat-datepicker
                                            #pickerDateNaissance></mat-datepicker>
                                    </mat-form-field>
                                </div>

                                <div class="col-md-3 col-sm-6 col-lg-3">
                                    <mat-form-field
                                        appearance="outline">
                                        <mat-label>Lieu de naissance
                                            <code
                                                class="fs-4">*</code></mat-label>
                                        <input
                                            [(ngModel)]="lieu_naissance"
                                            [readonly]="is_disabled == true"
                                            matInput
                                            placeholder="Lieu de naissance">
                                    </mat-form-field>
                                </div>

                                <div class="col-md-3 col-sm-6 col-lg-3">
                                    <mat-form-field
                                        appearance="outline">
                                        <mat-label>Lieu de résidence
                                            <code
                                                class="fs-4">*</code></mat-label>
                                        <input [(ngModel)]="lieu_residence"
                                            [readonly]="is_disabled == true"
                                            matInput
                                            placeholder="Lieu de résidence">
                                    </mat-form-field>
                                </div>

                                <div class="col-md-3 col-sm-6 col-lg-3">
                                    <mat-form-field
                                        appearance="outline">
                                        <mat-label>Nationalité
                                            <code
                                                class="fs-4">*</code></mat-label>
                                        <input [(ngModel)]="nationalite"
                                            matInput
                                            [readonly]="is_disabled == true"
                                            placeholder="Nationalité">
                                    </mat-form-field>
                                </div>

                                <div class="col-md-3 col-sm-6 col-lg-3">
                                    <mat-form-field
                                        appearance="outline">
                                        <mat-label>Antécédent medical
                                            <code
                                                class="fs-4">*</code></mat-label>
                                        <input [(ngModel)]="antecedant_medicaux"
                                            matInput
                                            [readonly]="is_disabled == true"
                                            placeholder="Antécédent medical">
                                    </mat-form-field>
                                </div>

                                <div class="col-md-3 col-sm-6 col-lg-3">
                                    <mat-form-field
                                        appearance="outline">
                                        <mat-label>Nombre de personnes à charge
                                            <code
                                                class="fs-4">*</code></mat-label>
                                        <input [(ngModel)]="personne_a_charge"
                                            matInput
                                            [readonly]="is_disabled == true"
                                            placeholder="Nombre de personnes à charge">
                                    </mat-form-field>
                                </div>

                                <div class="col-md-3 col-sm-6 col-lg-3">
                                    <mat-form-field
                                        appearance="outline">
                                        <mat-label>Situation Matrimoniale
                                            <code
                                                class="fs-4">*</code></mat-label>
                                        <input [(ngModel)]="situation_matrimoniale"
                                            matInput
                                            [readonly]="is_disabled == true"
                                            placeholder="Situation Matrimoniale">
                                    </mat-form-field>
                                </div>

                                <div class="col-md-3 col-sm-6 col-lg-3">
                                    <mat-form-field
                                        appearance="outline">
                                        <mat-label>Nom du conjoint
                                            <code
                                                class="fs-4">*</code></mat-label>
                                        <input [(ngModel)]="conjoint_name"
                                            matInput
                                            [readonly]="is_disabled == true"
                                            placeholder="Nom du conjoint">
                                    </mat-form-field>
                                </div>

                                <div class="col-md-3 col-sm-6 col-lg-3">
                                    <mat-form-field
                                        appearance="outline">
                                        <mat-label>Contact du conjoint
                                            <code
                                                class="fs-4">*</code></mat-label>
                                        <input [(ngModel)]="contact_conjoint"
                                            matInput
                                            [readonly]="is_disabled == true"
                                            placeholder="Contact du conjoint">
                                    </mat-form-field>
                                </div>

                                <div class="col-md-3 col-sm-6 col-lg-3">
                                    <mat-form-field
                                        appearance="outline">
                                        <mat-label>Personne à contacter
                                            <code
                                                class="fs-4">*</code></mat-label>
                                        <input [(ngModel)]="personne_a_contacter"
                                            matInput
                                            [readonly]="is_disabled == true"
                                            placeholder="Personne à contacter">
                                    </mat-form-field>
                                </div>

                           

                                <div class="col-md-3 col-sm-6 col-lg-3">
                                    <mat-form-field
                                        appearance="outline">
                                        <mat-label>Numéro de la personne à contacter
                                            <code
                                                class="fs-4">*</code></mat-label>
                                        <input [(ngModel)]="contact_personne_a_contacter"
                                            matInput
                                            [readonly]="is_disabled == true"
                                            placeholder="Contact de la personne à contacter">
                                    </mat-form-field>
                                </div>



                                <div class="col-md-3 col-sm-6 col-lg-3">
                                    <mat-form-field
                                        appearance="outline">
                                        <mat-label>Situation Matrimoniale<code
                                                class="fs-4">*</code></mat-label>
                                        <mat-select
                                            [disabled]="is_disabled == true"
                                            [(value)]="selectedSituationMatrimonialeOption"
                                            (selectionChange)="selectSituationMatrimoniale($event)">
                                            @for (item_situation of list_situation_matrimoniale; track $index) {
                                                <mat-option
                                                    [value]="item_situation.situation_matrimoniale">
                                                    {{
                                                        item_situation.situation_matrimoniale
                                                    }}
                                                </mat-option>
                                            }
                                        </mat-select>
                                    </mat-form-field>
                                </div>

                                <div class="col-md-3 col-lg-3">
                                    <mat-form-field
                                        appearance="outline">
                                        <mat-label>Nombre d'enfant à charge
                                            <code
                                                class="fs-4">*</code></mat-label>
                                        <input type="number"
                                            [(ngModel)]="nombre_enfant_a_charge"
                                            [readonly]="is_disabled == true"
                                            matInput
                                            placeholder="Nombre d'enfants à charge">
                                    </mat-form-field>
                                </div>

                                <div class="col-md-3 col-lg-3">
                                    <mat-form-field
                                        appearance="outline">
                                        <mat-label>Type de pièce<code
                                                class="fs-4">*</code></mat-label>
                                        <mat-select
                                            [disabled]="is_disabled == true"
                                            [(value)]="selectedPieceOption"
                                            (selectionChange)="selectPiece($event)">
                                            @for (item_piece of list_piece; track $index) {
                                                <mat-option
                                                    [value]="item_piece.piece">{{
                                                    item_piece.piece }}
                                                </mat-option>
                                            }
                                        </mat-select>
                                    </mat-form-field>
                                </div>

                                <div class="col-md-3 col-lg-3">
                                    <mat-form-field
                                        appearance="outline">
                                        <mat-label>N° Pièce d'identité
                                            <code
                                                class="fs-4">*</code></mat-label>
                                        <input [(ngModel)]="piece_number"
                                            matInput
                                            [readonly]="is_disabled == true"
                                            placeholder="N° Pièce d'identité">
                                    </mat-form-field>
                                </div>

                               

                                <div class="mt-3 text-center">
                                    @if (is_disabled == true) {
                                        <button (click)="edited()"
                                            class="default__btn__lg"
                                            mat-raised-button color="primary">
                                            <mat-icon>edit_square</mat-icon>
                                            Editer
                                        </button>
                                    }
                                    @if (is_disabled == false) {
                                        <button (click)="cancel()"
                                            class="default__btn__lg me-3"
                                            mat-raised-button color="warn">
                                            <mat-icon>cancel</mat-icon>
                                            annuler
                                        </button>
                                    }
                                    @if (is_disabled == false) {
                                        <button
                                            (click)="updateEmployeInformationPersonnelle()"
                                            class="default__btn__lg"
                                            mat-raised-button color="primary">
                                            <mat-icon>update</mat-icon>
                                            Modifier les informations
                                        </button>
                                    }
                                </div>

                            </div>
                        </mat-tab>

                        <mat-tab>
                            <ng-template mat-tab-label>
                                <mat-icon
                                    class="example-tab-icon me-2">gavel</mat-icon>
                                <span class="text-primary fs-5">
                                    Information professionnelle
                                </span>

                            </ng-template>
                            <div class="row gx-3 m-3 ">

                                <div class="col-md-6 col-sm-6 col-lg-6">
                                    <mat-form-field
                                        appearance="outline">
                                        <mat-label>Contrats<code
                                                class="fs-4">*</code></mat-label>
                                        <mat-select
                                            [disabled]="is_disabled_contrats == true"
                                            [(value)]="selectedContratsOption"
                                            (selectionChange)="selectContrats($event)">

                                            @for (item_contrats of
                                            list_contrats; track $index) {
                                            <mat-option
                                                [value]="item_contrats.id">{{
                                                item_contrats.contrats
                                                }}
                                            </mat-option>
                                            }
                                        </mat-select>
                                    </mat-form-field>
                                </div>
                                
                                <div class="col-md-6 col-sm-6 col-lg-6">
                                    <mat-form-field
                                        appearance="outline">
                                        <mat-label>fonction de l'employé
                                            <code
                                                class="fs-4">*</code></mat-label>
                                        <mat-select
                                            [(value)]="selectedFonctionOption"
                                            [disabled]="is_disabled_contrats == true"
                                            (selectionChange)="selectFonction($event)">
                                            @for (item_fonction of
                                            list_fonction; track $index) {
                                                <mat-option
                                                    [value]="item_fonction.id">
                                                    {{
                                                        item_fonction.fonction
                                                    }}
                                                </mat-option>
                                            }
                                        </mat-select>
                                    </mat-form-field>
                                </div>

                                <div class="col-md-6 col-sm-6 col-lg-6">
                                    <mat-form-field
                                        appearance="outline">
                                        <mat-label>Lieu de travail<code
                                                class="fs-4">*</code></mat-label>
                                        <mat-select
                                            [(value)]="selectedBureauOption"
                                            [disabled]="is_disabled_contrats == true"
                                            (selectionChange)="selectBureau($event)">
                                            @for (item_bureau of list_bureau; track $index) {
                                                <mat-option
                                                    [value]="item_bureau.id">{{
                                                    item_bureau.bureau
                                                    }}
                                                </mat-option>
                                            }
                                        </mat-select>
                                    </mat-form-field>
                                </div>

                                <div class="col-md-6 col-sm-6 col-lg-6">
                                    <mat-form-field
                                        appearance="outline">
                                        <mat-label>Servcie de l'employé<code
                                                class="fs-4">*</code></mat-label>
                                        <mat-select
                                            [(value)]="selectedServiceOption"
                                            [disabled]="is_disabled_contrats == true"
                                            (selectionChange)="selectService($event)">
                                            @for (item_service of list_service; track $index) {
                                                <mat-option
                                                    [value]="item_service.id">{{
                                                    item_service.service
                                                    }}
                                                </mat-option>
                                            }
                                        </mat-select>
                                    </mat-form-field>
                                </div>

                                <div class="col-md-6 col-sm-6 col-lg-6">
                                    <mat-form-field
                                        appearance="outline">
                                        <mat-label>Date debut de contrat<code
                                                class="fs-4">*</code></mat-label>
                                        <input [(ngModel)]="date_embauche"
                                            matInput
                                            [readonly]="is_disabled_contrats == true"
                                            [matDatepicker]="dateEmbauchePicker">
                                        <mat-datepicker-toggle
                                            matIconSuffix
                                            [for]="dateEmbauchePicker"></mat-datepicker-toggle>
                                        <mat-datepicker
                                            #dateEmbauchePicker></mat-datepicker>
                                    </mat-form-field>
                                </div>

                                <div class="col-md-6 col-sm-6 col-lg-6">
                                    <mat-form-field
                                        appearance="outline">
                                        <mat-label>Date fin de contrats<code
                                                class="fs-4">*</code></mat-label>
                                        <input [(ngModel)]="date_embauche_end"
                                            matInput
                                            [readonly]="is_disabled_contrats == true"
                                            [matDatepicker]="dateEmbaucheEndPicker">
                                        <mat-datepicker-toggle
                                            matIconSuffix
                                            [for]="dateEmbaucheEndPicker"></mat-datepicker-toggle>
                                        <mat-datepicker
                                            #dateEmbaucheEndPicker></mat-datepicker>
                                    </mat-form-field>
                                </div>

                                <div class="col-md-6 col-sm-6 col-lg-6">
                                    <mat-form-field
                                        appearance="outline">
                                        <mat-label>Catégorie
                                            professionnnelle<code
                                                class="fs-4">*</code></mat-label>
                                        <mat-select
                                            [(value)]="selectedCategorieProfessionnelleOption"
                                            [disabled]="is_disabled_contrats == true"
                                            (selectionChange)="selectCategorieProfessionnelle($event)">
                                            @for (item_categorie_pro of list_categorie_pro; track $index) {
                                                <mat-option
                                                    [value]="item_categorie_pro.id">{{
                                                    item_categorie_pro.categorie_pro
                                                    }}
                                                </mat-option>
                                            }
                                        </mat-select>
                                    </mat-form-field>
                                </div>

                                <!-- <div class="col-md-6 col-sm-6 col-lg-6">
                                    <mat-form-field
                                        appearance="outline">
                                        <mat-label>N° CNPS
                                            <code
                                                class="fs-4">*</code></mat-label>
                                        <input [(ngModel)]="cnps_number"
                                            [readonly]="is_disabled == true"
                                            matInput placeholder="N° CNPS">
                                    </mat-form-field>
                                </div> -->
                                <div class="col-md-6 col-sm-6 col-lg-6">
                                    <mat-form-field
                                        appearance="outline">
                                        <mat-label>N° CNPS <code
                                                class="fs-4">*</code></mat-label>
                                        <input type="text"
                                            [(ngModel)]="cnps_number"
                                            matInput
                                            [readonly]="is_disabled_contrats == true"
                                            placeholder="N° CNPS ">
                                    </mat-form-field>
                                </div>
                               
                                <div class="col-md-6 col-sm-6 col-lg-6">
                                    <mat-form-field
                                        appearance="outline">
                                        <mat-label>Salaire net mensuel <code
                                                class="fs-4">*</code></mat-label>
                                        <input type="number"
                                            [(ngModel)]="salaire_net_mensuel"
                                            matInput
                                            [readonly]="is_disabled_contrats == true"
                                            placeholder="Salaire net mensuel ">
                                    </mat-form-field>
                                </div>

                                <!-- <div class="col-md-6 col-sm-6 col-lg-6">
                                    <mat-form-field
                                        appearance="outline">
                                        <mat-label>Augmantation <code
                                                class="fs-4">*</code></mat-label>
                                        <input 
                                            [(ngModel)]="augmantation"
                                            matInput
                                            [readonly]="is_disabled_contrats == true"
                                            placeholder="Augmantation">
                                    </mat-form-field>
                                </div>

                                <div class="col-md-6 col-sm-6 col-lg-6">
                                    <mat-form-field
                                        appearance="outline">
                                        <mat-label>Date d'augmantation<code
                                                class="fs-4">*</code></mat-label>
                                        <input [(ngModel)]="date_augmantation"
                                            matInput
                                            [readonly]="is_disabled_contrats == true"
                                            [matDatepicker]="dateAugmentPicker">
                                        <mat-datepicker-toggle
                                            matIconSuffix
                                            [for]="dateAugmentPicker"></mat-datepicker-toggle>
                                        <mat-datepicker
                                            #dateAugmentPicker></mat-datepicker>
                                    </mat-form-field>
                                </div> -->

                                <div class="col-md-6 col-sm-6 col-lg-6">
                                    <mat-form-field
                                        appearance="outline">
                                        <mat-label>Avantage <code
                                                class="fs-4">*</code></mat-label>
                                        <input 
                                            [(ngModel)]="avantage"
                                            matInput
                                            [readonly]="is_disabled_contrats == true"
                                            placeholder="Avantage">
                                    </mat-form-field>
                                </div>

                                <div class="mt-3 text-center">
                                    @if (is_disabled_contrats == true) {
                                        <button (click)="editedContrats()"
                                            class="default__btn__lg"
                                            mat-raised-button color="primary">
                                            <mat-icon>edit_square</mat-icon>
                                            Editer
                                        </button>
                                    }
                                    @if (is_disabled_contrats == false) {
                                        <button (click)="cancelContrats()"
                                            class="default__btn__lg me-3"
                                            mat-raised-button color="warn">
                                            <mat-icon>cancel</mat-icon>
                                            annuler
                                        </button>
                                    }
                                    @if (is_disabled_contrats == false) {
                                        <button
                                            (click)="updateEmployeInformationContrats()"
                                            class="default__btn__lg"
                                            mat-raised-button color="primary">
                                            <mat-icon>update</mat-icon>
                                            Modifier les informations
                                        </button>
                                    }
                                </div>
                            </div>
                        </mat-tab>

                        <mat-tab>
                            <ng-template mat-tab-label>
                                <mat-icon
                                    class="example-tab-icon me-2">folder</mat-icon>
                                <span class="text-primary fs-5">
                                    Dossier
                                </span>

                            </ng-template>

                            <div class="row gx-3 m-3 justify-content-center">
                                <div class="col-12">
                                    @if (employee_dossier == null ) {
                                    <div class="text-center">
                                        <img src="assets/media/folder.svg"
                                            width="300" alt="logo oipi"
                                            class="img-fluid mb-2">

                                        <p
                                            class="mb-4 fw-bolder fs-5 text-primary">Aucun
                                            dossier n'est disponible pour vous.

                                        </p>
                                    </div>
                                    }

                                    @if (employee_dossier != null ) {

                                    <div class="text-center">

                                        <div class="table-responsive">
                                            <table
                                                class="table table-striped mt-3 align-middle">
                                                <thead>
                                                    <tr>
                                                        <th
                                                            class="text-center">Libellé
                                                            du dossier</th>
                                                        <th
                                                            class="text-center">Date
                                                            de création</th>
                                                        <th
                                                            class="text-center">Statut</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr>
                                                        <td class="text-center">

                                                            <div
                                                                class="d-flex justify-content-center">
                                                                <mat-icon
                                                                    class="me-3 text-primary">folder</mat-icon>
                                                                <p
                                                                    class="m-0 fw-bolder fs-6">{{
                                                                    employee_dossier.libelle_dossiers
                                                                    }}</p>
                                                            </div>

                                                        </td>

                                                        <td
                                                            class="text-center">{{
                                                            employee_dossier.created_at
                                                            | transformDate:
                                                            " d MMMM YYYY "
                                                            }}</td>

                                                        <td class="text-center">

                                                            <button
                                                                matTooltip="Dossier validé"
                                                                *ngIf="employee_dossier.status_folder_on == 1"
                                                                mat-icon-button>
                                                                <mat-icon
                                                                    class="text-primary">verified</mat-icon>
                                                            </button>

                                                            <button
                                                                matTooltip="Dossier rejeté"
                                                                *ngIf="employee_dossier.status_folder_off == 1"
                                                                mat-icon-button>
                                                                <mat-icon
                                                                    class="text-primary">verified</mat-icon>
                                                            </button>

                                                            <button
                                                                matTooltip="En entente de validation du dossier"
                                                                *ngIf="employee_dossier.status_folder_on == 0 && employee_dossier.status_folder_off == 0"
                                                                mat-icon-button>
                                                                <mat-icon
                                                                    class="text-blue">pending</mat-icon>
                                                            </button>

                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                    }
                                </div>
                            </div>
                        </mat-tab>
                    </mat-tab-group>
                </div>
            </div>
        </div>
    </div>
</div>
<ngx-spinner type = "ball-circus" size = "large" color = "#ef8f01" [fullScreen] = "true">
    <p style="color: #fff; font-size: 1.2rem" > Chargement en cours... </p>
</ngx-spinner>
